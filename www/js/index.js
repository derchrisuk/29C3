// Generated by CoffeeScript 1.3.3
var App, app, programXML, xmlLoader;

xmlLoader = new ScheduleXMLLoader();

xmlLoader.appStartUpLoad();

programXML = xmlLoader.getXMLTree();

App = (function() {

  App.programXML;

  function App() {
    document.addEventListener('deviceready', this.deviceready(), false);
  }

  App.prototype.deviceready = function() {
    var a, dayIndex, dayNode, dayTab, _i, _len, _ref, _results;
    _ref = programXML.find('day');
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      dayNode = _ref[_i];
      dayNode = $(dayNode);
      dayTab = $('.tabs li:first').clone();
      dayIndex = dayNode.attr('index');
      dayTab.attr({
        'data-day-index': dayIndex
      });
      a = dayTab.find('a:first');
      a.attr('href', "#schedule#" + dayIndex);
      a.html(dayNode.attr('date'));
      _results.push($('.tabs').append($('<div />').append(dayTab.show()).html()));
    }
    return _results;
  };

  return App;

})();

$(document).bind('pagebeforechange', function(event, data) {
  var dayNode, parsedUrl, _i, _len, _ref, _results;
  if (typeof data.toPage === 'string') {
    parsedUrl = $.mobile.path.parseUrl(data.toPage);
    if (parsedUrl.filename === 'index.html' && /^#schedule#/.test(parsedUrl.hash)) {
      _ref = programXML.find('day');
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        dayNode = _ref[_i];
        dayNode = $(dayNode);
        if (dayNode.attr('index') === parsedUrl.hash.split('#')[2]) {
          schedule.initialize(dayNode, data.option);
          event.preventDefault();
          break;
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    }
  }
});

app = new App;
