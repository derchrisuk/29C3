// Generated by CoffeeScript 1.3.3
var ScheduleXMLLoader;

ScheduleXMLLoader = (function() {

  function ScheduleXMLLoader() {}

  ScheduleXMLLoader.prototype.loadFromServer = function(programmXMLUrl, doneCallback) {
    return $.ajax({
      url: programmXMLUrl,
      dataType: 'text',
      async: false,
      timeout: 2000
    }).done(function(responseXML) {
      return doneCallback(responseXML);
    }).error(function() {
      throw 'Unable to load from server';
    });
  };

  ScheduleXMLLoader.prototype.appStartUpLoad = function() {
    try {
      return this.loadFromServer(config.programXMLUrl, function(programXML) {
        $($.parseXML(programXML));
        return userconfig.setItem('programXML', programXML);
      });
    } catch (e) {

    }
  };

  ScheduleXMLLoader.prototype.getXMLTree = function() {
    var programXML, xmlTree;
    programXML = userconfig.getItem('programXML');
    xmlTree = void 0;
    if (!programXML) {
      this.loadFromServer('schedule.xml', function(programXML) {
        return xmlTree = $($.parseXML(programXML));
      });
    } else {
      xmlTree = $($.parseXML(programXML));
    }
    return xmlTree;
  };

  return ScheduleXMLLoader;

})();
